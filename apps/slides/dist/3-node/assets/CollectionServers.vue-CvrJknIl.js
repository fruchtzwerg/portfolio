import{d as _,z as k,a1 as $,o,b as f,F as j,l as i,c as C,g as w,t as z,e as c,aQ as D,ak as I,S as t,x as B,k as v}from"./modules/vue-DqyYkKqv.js";import{F as A,j as E,aC as F,aH as P,E as R,aI as V,n as q,o as g,$ as U,x as H,C as L}from"./md-BLW5X4md.js";import{w as M}from"./DeleteSidebarListElement.vue-CN0nbuaK.js";import"./index-vLjcKSoT.js";import{q as O}from"./Form.vue-CJ7lCxI4.js";import"./modules/unplugin-icons-Oe2e3nhT.js";import"./slidev/context-5ERYHSt8.js";import"./modules/file-saver-BdX_bMbV.js";import"./modules/shiki-DBUm8ogk.js";import"./fuse-Ch1WBRTM.js";import"./layout-helper-BPQt8DFN.js";import"./ViewLayoutSection.vue-qkkO6JVP.js";const T={class:"bg-b-1 divide-0.5 flex w-full flex-col divide-y text-sm"},W=_({__name:"CollectionServerForm",props:{collectionId:{default:""},serverUid:{default:""}},setup(S){const r=S,{activeWorkspaceCollections:n}=A(),{servers:b,serverMutators:m}=E(),d=[{label:"URL",key:"url",placeholder:"https://void.scalar.com",type:"text"},{label:"Description",key:"description",placeholder:"Production",type:"text"}],a=k(()=>{const s=n.value.find(e=>e.uid===r.collectionId);return b[s&&typeof r.serverUid=="string"&&r.serverUid==="default"?s.servers[0]??"":(s==null?void 0:s.servers.find(e=>e===r.serverUid))??""]}),x=k(()=>{var s,e;return(s=a.value)!=null&&s.url?((e=a.value.url.match(F.PATH))==null?void 0:e.map(l=>l.slice(1,-1)))??[]:[]});$(x,s=>{if(!a.value)return;const e=a.value.variables?{...a.value.variables}:{};Object.keys(e).forEach(l=>{s.includes(l)||delete e[l]}),s.forEach(l=>{e[l]||(e[l]={default:""})}),m.edit(a.value.uid,"variables",e)},{immediate:!0});const h=(s,e)=>{!n.value||!a.value||m.edit(a.value.uid,s,e)},y=(s,e)=>{if(!a.value)return;const l=a.value.variables||{};l[s]={...l[s],default:e},m.edit(a.value.uid,"variables",l)};return(s,e)=>(o(),f("div",T,[a.value?(o(),f(j,{key:0},[i(O,{data:a.value,onUpdate:h,options:d},null,8,["data"]),a.value.variables?(o(),C(P,{key:0,variables:a.value.variables,"onUpdate:variable":y},null,8,["variables"])):w("",!0)],64)):w("",!0)]))}}),G={class:"flex h-full w-full flex-col gap-12 px-1.5 pt-8"},Y={class:"flex flex-col gap-4"},Q={class:"bg-b-2 overflow-hidden rounded-lg border"},X={class:"flex items-center justify-between py-1 pl-3 pr-1 text-sm"},J={key:1},K={class:"text-c-3 flex h-full items-center justify-center rounded-lg border p-4"},ve=_({__name:"CollectionServers",setup(S){const{activeCollection:r}=A(),{servers:n,events:b,serverMutators:m}=E(),d=R(),a=z(null),x=k(()=>{var e;return!n||!((e=r.value)!=null&&e.servers)?[]:Object.values(n).filter(l=>{var p;return(p=r.value)==null?void 0:p.servers.includes(l.uid)})}),h=()=>b.commandPalette.emit({commandName:"Add Server"}),y=()=>{var e;!((e=r.value)!=null&&e.uid)||!a.value||(m.delete(a.value,r.value.uid),d.hide())},s=e=>{a.value=e,d.show()};return(e,l)=>{var p;return o(),f("div",G,[c("div",Y,[l[3]||(l[3]=D('<div class="flex items-start justify-between gap-2"><div class="flex flex-col"><div class="flex h-8 items-center"><h3 class="font-bold">Servers</h3></div><p class="text-sm"> Add different base URLs for your API. You can use <code class="font-code text-c-2">{variables}</code> for dynamic parts. </p></div></div>',1)),(o(!0),f(j,null,I(x.value,(u,N)=>(o(),f("div",{key:u.uid},[c("div",Q,[c("div",X,[u.description?(o(),C(t(V),{key:0,value:u.description},null,8,["value"])):(o(),f("span",J,"Server "+B(N+1),1)),i(t(H),{placement:"bottom-end"},{items:v(()=>[i(t(q),{class:"flex gap-2 font-normal",onClick:Z=>s(u.uid)},{default:v(()=>[i(t(g),{class:"inline-flex",icon:"Delete",size:"sm",thickness:"1.5"}),l[1]||(l[1]=c("span",null,"Delete",-1))]),_:2},1032,["onClick"])]),default:v(()=>[i(t(U),{class:"hover:bg-b-3 h-full max-h-8 gap-1 p-1 text-xs",variant:"ghost"},{default:v(()=>[i(t(g),{class:"text-c-3",icon:"Ellipses",size:"md"})]),_:1})]),_:2},1024)]),t(r)?(o(),C(W,{key:0,collectionId:t(r).uid,serverUid:u.uid},null,8,["collectionId","serverUid"])):w("",!0)])]))),128)),c("div",K,[i(t(U),{class:"hover:bg-b-2 hover:text-c-1 flex items-center gap-2",size:"sm",variant:"ghost",onClick:h},{default:v(()=>[i(t(g),{class:"inline-flex",icon:"Add",size:"sm",thickness:"1.5"}),l[2]||(l[2]=c("span",null,"Add Server",-1))]),_:1})])]),i(t(L),{size:"xxs",state:t(d),title:`Delete ${a.value?(p=t(n)[a.value])==null?void 0:p.url:"Server"}`},{default:v(()=>[i(M,{variableName:"Server",warningMessage:"Are you sure you want to delete this server? This action cannot be undone.",onClose:l[0]||(l[0]=u=>t(d).hide()),onDelete:y})]),_:1},8,["state","title"])])}}});export{ve as default};
