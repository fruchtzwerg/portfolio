import{d as A,t as E,z as le,a1 as q,o as v,b as D,g as V,F as U,i as w,h as O,c as _,S as s,ak as T,e as C,ai as ne,aj as Ce,l as f,n as ke,k as h,x as G,ae as J,R as ye,a2 as ge,K as Ee,D as we,av as _e,an as $e,a_ as ze}from"./modules/vue-DqyYkKqv.js";import{o as W,C as H,j as te,a1 as Ie,$ as L,k as ae,F as Se,m as je,E as P,y as g,ay as Ve}from"./md-BLW5X4md.js";import{d as De}from"./LibraryIcon.vue-Ddhw8gnU.js";import{C as Me}from"./EditSidebarListElement.vue-DpLjXntZ.js";import{m as Ne,g as We}from"./SidebarButton.vue-Dwlgezl5.js";import{h as Be,b as Re,_ as Fe,a as ee}from"./CommandActionInput.vue-h_ItZ7kG.js";import{u as Oe}from"./ViewLayout.vue-BS7YKYay.js";import{x as Ue}from"./ViewLayoutContent.vue-hARDt20b.js";import{_ as Ae}from"./ViewLayoutSection.vue-qkkO6JVP.js";import{a as Ke}from"./DeleteSidebarListElement.vue-CN0nbuaK.js";import"./modules/unplugin-icons-Oe2e3nhT.js";import"./slidev/context-5ERYHSt8.js";import"./index-vLjcKSoT.js";import"./modules/shiki-DBUm8ogk.js";import"./modules/file-saver-BdX_bMbV.js";import"./fuse-Ch1WBRTM.js";import"./layout-helper-BPQt8DFN.js";import"./ScalarHotkey.vue-nmq20aUh.js";const Pe=["onClick"],Te=["placeholder"],oe=A({__name:"EnvironmentColors",props:{activeColor:{},selector:{type:Boolean,default:!1}},emits:["select"],setup(B,{emit:$}){const o=B,y=$,p=E(""),i=E(null),k=E(!1),b=E(!1),d=[{color:"#8E8E8E"},{color:"#EF0006"},{color:"#EDBE20"},{color:"#069061"},{color:"#FB892C"},{color:"#0082D0"},{color:"#5203D1"},{color:"#FFC0CB"}],z=le(()=>o.activeColor&&!d.some(t=>t.color===o.activeColor)||p.value?`background-color: ${o.activeColor||p.value};`:"background: linear-gradient(to right, rgb(235, 87, 87), rgb(242, 201, 76), rgb(76, 183, 130), rgb(78, 167, 252), rgb(250, 96, 122));"),I=()=>{k.value=!k.value,o.selector&&(b.value=!1),ke(()=>{i.value&&i.value.focus()})};q(p,t=>{t&&!t.startsWith("#")&&(p.value=`#${t}`),k.value=!0});const M=()=>{o.selector&&(b.value=!b.value)},S=t=>{y("select",t),o.selector&&(b.value=!1)};return(t,a)=>(v(),D("div",null,[k.value?V("",!0):(v(),D(U,{key:0},[o.selector&&!b.value?(v(),D("div",{key:0,class:w(["flex cursor-pointer items-center justify-center rounded-full",o.selector?"h-4 w-4":"h-5 w-5"]),style:O({backgroundColor:t.activeColor}),onClick:M},[t.activeColor?(v(),_(s(W),{key:0,class:w(["text-c-btn",o.selector&&"p-0.5"]),icon:"Checkmark",size:"xs"},null,8,["class"])):V("",!0)],6)):V("",!0),b.value||!o.selector?(v(),D("div",{key:1,class:w(["color-selector flex flex-row items-center justify-between gap-1.5 space-x-1",o.selector?"h-4":"min-h-10 min-w-[296px]"])},[(v(),D(U,null,T(d,m=>C("div",{key:m.color,class:w(["flex cursor-pointer items-center justify-center rounded-full",o.selector?"h-4 w-4":"h-5 w-5"]),style:O({backgroundColor:m.color}),onClick:u=>S(m.color)},[t.activeColor===m.color&&!p.value?(v(),_(s(W),{key:0,class:w(["text-c-btn",o.selector&&"p-0.5"]),icon:"Checkmark",size:"xs"},null,8,["class"])):V("",!0)],14,Pe)),64)),a[2]||(a[2]=C("hr",{class:"border-ghost h-5 w-0.5 border-l"},null,-1)),C("label",{class:w(["z-10 flex cursor-pointer flex-row items-center justify-center gap-2 rounded-full",o.selector?"h-4 w-4":"h-5 w-5"]),style:O(z.value),onClick:I},[!k.value&&(t.activeColor===p.value||t.activeColor&&!d.some(m=>m.color===t.activeColor))?(v(),_(s(W),{key:0,class:"text-c-btn",icon:"Checkmark",size:"xs"})):V("",!0)],6)],2)):V("",!0)],64)),k.value?(v(),D("div",{key:1,class:w(["color-selector flex flex-1 items-center gap-2 rounded",o.selector?"h-4":"min-h-10"])},[C("span",{class:w(["absolute rounded-full border border-dashed",o.selector?"h-4 w-4":"h-5 w-5"])},null,2),C("span",{class:w(["z-[1] rounded-full",o.selector?"h-4 w-4":"h-5 w-5"]),style:O(z.value)},null,6),ne(C("input",{ref_key:"customColorInputRef",ref:i,"onUpdate:modelValue":a[0]||(a[0]=m=>p.value=m),class:"w-full flex-1 border-transparent text-sm outline-none",placeholder:t.activeColor||"#000000",type:"text",onInput:a[1]||(a[1]=m=>S(p.value))},null,40,Te),[[Ce,p.value]]),C("button",{class:"text-c-3 hover:bg-b-2 rounded-lg p-1.5",type:"button",onClick:I},[f(s(W),{icon:"Checkmark",size:"xs"})])],2)):V("",!0)]))}}),Ge={class:"flex flex-col gap-4"},Je=A({__name:"EnvironmentColorModal",props:{state:{},selectedColor:{}},emits:["cancel","submit"],setup(B,{emit:$}){const o=B,y=$,p=E(""),i=b=>{p.value=b},k=()=>{y("submit",p.value),p.value=""};return(b,d)=>(v(),_(s(H),{size:"xxs",state:b.state,title:"Edit Environment Color"},{default:h(()=>[C("div",Ge,[f(oe,{activeColor:p.value||o.selectedColor,class:"w-full p-1",onSelect:i},null,8,["activeColor"]),f(Ke,{onCancel:d[0]||(d[0]=z=>y("cancel")),onSubmit:k})])]),_:1},8,["state"]))}}),Le={class:"flex items-start gap-2"},qe=A({__name:"EnvironmentModal",props:{state:{},activeWorkspaceCollections:{},collectionId:{}},emits:["cancel","submit"],setup(B,{emit:$}){const o=B,y=$,{events:p}=te(),i=E(""),k=E("#8E8E8E"),b=le(()=>[...o.activeWorkspaceCollections.filter(t=>{var a;return((a=t.info)==null?void 0:a.title)!=="Drafts"}).map(t=>{var a;return{id:t.uid,label:((a=t.info)==null?void 0:a.title)??"Untitled Collection"}})]),d=E(b.value.find(t=>t.id===o.collectionId)),{toast:z}=ae(),I=t=>{k.value=t};q(()=>o.state.open,t=>{t&&(i.value="",k.value="#8E8E8E",o.collectionId?d.value=b.value.find(a=>a.id===o.collectionId):d.value=void 0)});const M=()=>{var t,a,m,u;if(!((t=d.value)!=null&&t.id)){z("Please select a collection before adding an environment.","error");return}y("submit",{name:i.value,color:k.value,type:((a=d.value)==null?void 0:a.id)==="global"?"global":"collection",collectionId:((m=d.value)==null?void 0:m.id)!=="global"?(u=d.value)==null?void 0:u.id:void 0})},S=()=>{o.state.hide(),p.commandPalette.emit({commandName:"Create Collection"})};return(t,a)=>(v(),_(s(H),{bodyClass:"border-t-0 rounded-t-lg",size:"xs",state:t.state},{default:h(()=>[f(Be,{disabled:!d.value,onCancel:a[2]||(a[2]=m=>y("cancel")),onSubmit:M},{options:h(()=>[f(s(Ie),{modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=m=>d.value=m),options:b.value,placeholder:"Select Type"},{default:h(()=>[b.value.length>0?(v(),_(s(L),{key:0,class:"hover:bg-b-2 max-h-8 w-fit justify-between gap-1 p-2 text-xs",variant:"outlined"},{default:h(()=>[C("span",{class:w(d.value?"text-c-1":"text-c-3")},G(d.value?d.value.label:"Select Collection"),3),f(s(W),{class:"text-c-3",icon:"ChevronDown",size:"xs"})]),_:1})):(v(),_(s(L),{key:1,class:"hover:bg-b-2 max-h-8 justify-between gap-1 p-2 text-xs",variant:"outlined",onClick:S},{default:h(()=>a[3]||(a[3]=[C("span",{class:"text-c-1"},"Create Collection",-1)])),_:1}))]),_:1},8,["modelValue","options"])]),submit:h(()=>a[4]||(a[4]=[J(" Add Environment ")])),default:h(()=>[C("div",Le,[f(oe,{activeColor:k.value,class:"peer",selector:"",onSelect:I},null,8,["activeColor"]),f(Re,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=m=>i.value=m),class:"-mt-[.5px] !p-0 peer-has-[.color-selector]:hidden",placeholder:"Environment name"},null,8,["modelValue"])])]),_:1},8,["disabled"])]),_:1},8,["state"]))}}),He={class:"flex-1"},Qe=["onClick"],Xe={class:"flex h-5 max-w-[14px] items-center justify-center"},bl=A({__name:"Environment",setup(B){const $=ye(),o=ge(),{activeWorkspace:y,activeEnvironment:p,activeWorkspaceCollections:i,activeEnvVariables:k}=Se(),{events:b,workspaceMutators:d,collectionMutators:z}=te(),{collapsedSidebarFolders:I,toggleSidebarFolder:M}=je(),S=P(),t=P(),a=P(),m=E(null),u=E("default"),Q=E(""),R=E(void 0),j=E(void 0),F=E(void 0),{toast:X}=ae(),re=l=>JSON.parse(l);function Y(l,n,e){var r;l&&(n.uid===e?X(`Environment name already used in ${(r=n.info)==null?void 0:r.title}`,"error"):X("Environment name already used in another collection","error"))}function se(l){i.value.some(n=>{const e=Object.keys(n["x-scalar-environments"]||{}).includes(l.name);return Y(e,n,l.collectionId),e})||(l.collectionId&&(z.addEnvironment(l.name,{variables:{},color:l.color},l.collectionId),I[l.collectionId]||M(l.collectionId),$.push({name:"environment.collection",params:{[g.Collection]:l.collectionId,[g.Environment]:l.name}})),t.hide())}function ie(l){var n,e;if(p){const r=re(l);if(u.value==="default")d.edit((n=y.value)==null?void 0:n.uid,"environments",r);else{const x=i.value.find(c=>{var N;return(N=c["x-scalar-environments"])==null?void 0:N[u.value??""]});if((e=x==null?void 0:x["x-scalar-environments"])!=null&&e[u.value??""]){const c=x["x-scalar-environments"][u.value??""];c&&(c.variables=r,z.edit(x.uid,"x-scalar-environments",x["x-scalar-environments"]))}}}}const K=l=>{R.value=l,t.show()},ue=(l,n)=>{j.value=l,R.value=n,F.value=l,a.show()},ce=l=>{var n,e,r;m.value=l,Q.value=((r=(e=(n=i.value.find(x=>{var c;return(c=x["x-scalar-environments"])==null?void 0:c[l]}))==null?void 0:n["x-scalar-environments"])==null?void 0:e[l])==null?void 0:r.color)??"",S.show()},de=l=>{const n=m.value;typeof n=="string"&&(i.value.some(e=>{var r;return(r=e["x-scalar-environments"])==null?void 0:r[n]})&&i.value.forEach(e=>{var r;(r=e["x-scalar-environments"])!=null&&r[n]&&(e["x-scalar-environments"][n].color=l,z.edit(e.uid,"x-scalar-environments",e["x-scalar-environments"]))}),S.hide())};function ve(l){i.value.forEach(e=>{z.removeEnvironment(l,e.uid)});const n=i.value.flatMap(e=>Object.keys(e["x-scalar-environments"]||{}));if(n.length>0){const e=n[n.length-1];if(!e)return;const r=i.value.find(x=>Object.keys(x["x-scalar-environments"]||{}).includes(e));u.value=e,$.push({name:"environment.collection",params:{collectionId:r==null?void 0:r.uid,environmentId:e}}),r&&!I[r.uid]&&M(r.uid)}else u.value="default",$.push({name:"environment",params:{environment:"default"}})}const me=()=>u.value==="default"?"Global Environment":u.value,fe=()=>{var l,n,e,r;return u.value==="default"?JSON.stringify((l=y.value)==null?void 0:l.environments,null,2):JSON.stringify((r=(e=(n=i.value.find(x=>{var c;return(c=x["x-scalar-environments"])==null?void 0:c[u.value??""]}))==null?void 0:n["x-scalar-environments"])==null?void 0:e[u.value??""])==null?void 0:r.variables,null,2)},pe=l=>I[l],Z=l=>{l!=null&&l.createNew&&o.name==="environment"&&K()};q(()=>[o.params[g.Collection],o.params[g.Environment]],([l,n])=>{l?u.value=n:u.value="default"}),Ee(()=>{u.value=o.params[g.Environment]||"default",b.hotKeys.on(Z);const l=o.params[g.Collection];l&&!I[l]&&M(l)}),we(()=>b.hotKeys.off(Z));const be=(l,n,e)=>{var r,x;const c=e?{name:"environment.collection",params:{[g.Workspace]:(r=y.value)==null?void 0:r.uid,[g.Collection]:e,[g.Environment]:n}}:{name:"environment.default",params:{[g.Workspace]:(x=y.value)==null?void 0:x.uid,[g.Environment]:n}};l.metaKey?window.open($.resolve(c).href,"_blank"):$.push(c)};function xe(){j.value=void 0,R.value=void 0,F.value=void 0,a.hide()}function he(l){i.value.some(n=>{const e=Object.keys(n["x-scalar-environments"]||{}).includes(l);return Y(e,n,R.value),e})||(l&&j.value!=="default"&&i.value.forEach(n=>{var e;if((e=n["x-scalar-environments"])!=null&&e[j.value??""]){const r=n["x-scalar-environments"][j.value??""];r&&(delete n["x-scalar-environments"][j.value??""],n["x-scalar-environments"][l]=r,z.edit(n.uid,"x-scalar-environments",n["x-scalar-environments"]))}}),l&&u.value===j.value&&(u.value=l),j.value=void 0,R.value=void 0,F.value=void 0,a.hide())}return(l,n)=>(v(),_(Oe,null,{default:h(()=>[f(Ne,{title:"Collections"},{content:h(()=>[C("div",He,[f(Fe,null,{default:h(()=>[(v(),_(ee,{key:"default",class:"text-xs",isCopyable:!1,to:{name:"environment.default",params:{[s(g).Environment]:"default"}},type:"environment",variable:{name:"Global Environment",uid:"default",icon:"Globe",isDefault:!0}},null,8,["to"])),(v(!0),D(U,null,T(s(i),e=>{var r;return v(),D("li",{key:e.uid,class:"gap-1/2 flex flex-col"},[C("button",{class:"hover:bg-b-2 group flex w-full items-center gap-1.5 break-words rounded p-1.5 text-left text-sm font-medium",type:"button",onClick:x=>s(M)(e.uid)},[C("span",Xe,[f(s(De),{class:"text-sidebar-c-2 size-3.5 min-w-3.5 stroke-2 group-hover:hidden",src:e["x-scalar-icon"]||"interface-content-folder"},null,8,["src"]),C("div",{class:w({"rotate-90":s(I)[e.uid]})},[f(s(W),{class:"text-c-3 hover:text-c-1 hidden text-sm group-hover:block",icon:"ChevronRight",size:"md"})],2)]),J(" "+G(((r=e.info)==null?void 0:r.title)??""),1)],8,Qe),ne(C("div",{class:w({"before:bg-border before:z-1 relative mb-[.5px] before:pointer-events-none before:absolute before:left-3 before:top-0 before:h-[calc(100%_+_.5px)] before:w-[.5px] last:mb-0 last:before:h-full":Object.keys(e["x-scalar-environments"]||{}).length>0})},[(v(!0),D(U,null,T(e["x-scalar-environments"],(x,c)=>(v(),_(ee,{key:c,class:"text-xs [&>a]:pl-5",collectionId:e.uid,isCopyable:!1,isDeletable:!0,isRenameable:!0,to:{name:"collection.environment",params:{[s(g).Collection]:e.uid,[s(g).Environment]:c}},type:"environment",variable:{name:c,uid:c,color:x.color??"#8E8E8E",isDefault:!1},warningMessage:"Are you sure you want to delete this environment?",onClick:_e(N=>be(N,c,e.uid),["prevent"]),onColorModal:N=>ce(c),onDelete:N=>ve(c),onRename:N=>ue(c,e.uid)},null,8,["collectionId","to","variable","onClick","onColorModal","onDelete","onRename"]))),128)),Object.keys(e["x-scalar-environments"]||{}).length===0?(v(),_(s(L),{key:0,class:"text-c-1 hover:bg-b-2 flex h-8 w-full justify-start gap-1.5 py-0 pl-6 text-xs",variant:"ghost",onClick:x=>K(e.uid)},{default:h(()=>[f(s(W),{icon:"Add",size:"sm"}),n[2]||(n[2]=C("span",null,"Add Environment",-1))]),_:2},1032,["onClick"])):V("",!0)],2),[[$e,pe(e.uid)]])])}),128))]),_:1})])]),button:h(()=>[f(We,{click:K,hotkey:"N"},{title:h(()=>n[3]||(n[3]=[J(" Add Environment ")])),_:1})]),_:1}),f(Ue,{class:"flex-1"},{default:h(()=>[f(Ae,null,ze({default:h(()=>[u.value&&s(y)?(v(),_(Ve,{key:0,class:"py-2 pl-px pr-2 md:px-4",envVariables:s(k),environment:s(p),isCopyable:"",language:"json",lineNumbers:"",lint:"",modelValue:fe(),workspace:s(y),"onUpdate:modelValue":ie},null,8,["envVariables","environment","modelValue","workspace"])):V("",!0)]),_:2},[u.value?{name:"title",fn:h(()=>[C("span",null,G(me()),1)]),key:"0"}:void 0]),1024)]),_:1}),f(Je,{selectedColor:Q.value,state:s(S),onCancel:n[0]||(n[0]=e=>s(S).hide()),onSubmit:de},null,8,["selectedColor","state"]),f(qe,{activeWorkspaceCollections:s(i),collectionId:R.value,state:s(t),onCancel:n[1]||(n[1]=e=>s(t).hide()),onSubmit:se},null,8,["activeWorkspaceCollections","collectionId","state"]),f(s(H),{size:"xxs",state:s(a),title:`Edit ${j.value}`},{default:h(()=>[f(Me,{name:F.value??"",onClose:xe,onEdit:he},null,8,["name"])]),_:1},8,["state","title"])]),_:1}))}});export{bl as default};
